import requests
import random
import time
import json
import os

URL = "https://docs.google.com/forms/d/e/1FAIpQLSce7JvrJXbHWyWDoJmInk5A4sY5F_-4sUoQB-2G8-XC_N5Kwg/formResponse"
TOTAL_RESPONSES = 104
STATE_FILE = "state.json"

# --- –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ ---
options_map = {
    "entry.457041491": ["16 –ª–µ—Ç –∏ –º–ª–∞–¥—à–µ", "17‚Äì18 –ª–µ—Ç", "19‚Äì20 –ª–µ—Ç", "21‚Äì22 –≥–æ–¥–∞", "23 –≥–æ–¥–∞ –∏ —Å—Ç–∞—Ä—à–µ"],
    "entry.900081255": ["–ú—É–∂—Å–∫–æ–π", "–ñ–µ–Ω—Å–∫–∏–π"],
    "entry.2072137170": ["–≥. –ê—Å—Ç–∞–Ω–∞", "–≥. –ê–ª–º–∞—Ç—ã", "–≥. –®—ã–º–∫–µ–Ω—Ç", "–ê–∫—Ç—é–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å", "–ê–ª–º–∞—Ç–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å", "–ê—Ç—ã—Ä–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å", "–í–æ—Å—Ç–æ—á–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å", "–ó–∞–ø–∞–¥–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å", "–ö–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å", "–ö—ã–∑—ã–ª–æ—Ä–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å", "–¢—É—Ä–∫–µ—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å"],
    "entry.1467051264": ["–®–∫–æ–ª–∞", "–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç / –í—É–∑", "–†–∞–±–æ—Ç–∞"],
    "entry.2049384046": ["–ö–∞–∑–∞—Ö—Å–∫–∏–π", "–†—É—Å—Å–∫–∏–π", "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π", "–°–º–µ—à–∞–Ω–Ω—ã–π (–Ω–µ—Å–∫–æ–ª—å–∫–æ —è–∑—ã–∫–æ–≤)"],
    "entry.997831765": ["–ö–∞–∑–∞—Ö—Å–∫–∏–π", "–†—É—Å—Å–∫–∏–π", "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π"],
    "entry.2016190063": ["–ö–∞–∑–∞—Ö—Å–∫–∏–π", "–†—É—Å—Å–∫–∏–π", "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π"],
    "entry.1708145665": ["1", "2", "3", "4", "5"],
    "entry.1452720691": ["–°–ª–æ–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã.", "–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –≥–æ–≤–æ—Ä–∏—Ç —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ.", "–¢—Ä—É–¥–Ω–æ –±—ã—Å—Ç—Ä–æ –∫–æ–Ω—Å–ø–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.", "–°–ª–æ–∂–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∑–∞–Ω—è—Ç–∏—è—Ö.", "–¢—Ä—É–¥–Ω–æ—Å—Ç–µ–π –Ω–µ—Ç, —è –≤—Å—ë –ø–æ–Ω–∏–º–∞—é."],
    "entry.1794521284": ["–ò—â—É –ø–µ—Ä–µ–≤–æ–¥ –∏–ª–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –Ω–∞ —Ä–æ–¥–Ω–æ–º —è–∑—ã–∫–µ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ.", "–ü—Ä–æ—à—É –æ–¥–Ω–æ–≥—Ä—É–ø–ø–Ω–∏–∫–æ–≤/–¥—Ä—É–∑–µ–π –æ–±—ä—è—Å–Ω–∏—Ç—å –Ω–∞ –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω–æ–º —è–∑—ã–∫–µ.", "–ü—ã—Ç–∞—é—Å—å –¥–æ–≥–∞–¥–∞—Ç—å—Å—è –ø–æ —Å–º—ã—Å–ª—É –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É.", "–ñ–¥—É, –∫–æ–≥–¥–∞ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –æ–±—ä—è—Å–Ω–∏—Ç –µ—â–µ —Ä–∞–∑."],
    "entry.286483656": ["–î–∞, –ø–æ—Å—Ç–æ—è–Ω–Ω–æ (—Å–º–µ—à–∏–≤–∞—é —Ç–µ—Ä–º–∏–Ω—ã –∏–∑ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–æ–≤).", "–ò–Ω–æ–≥–¥–∞ (–∫–æ–≥–¥–∞ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç —Å–ª–æ–≤ –Ω–∞ –æ–¥–Ω–æ–º —è–∑—ã–∫–µ).", "–ù–µ—Ç, —Å—Ç–∞—Ä–∞—é—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —è–∑—ã–∫."],
    "entry.737822750": ["–î–∞, —ç—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –æ–±–ª–µ–≥—á–∞–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞.", "–ù–µ–º–Ω–æ–≥–æ –ø–æ–º–æ–≥–∞–µ—Ç, –Ω–æ –º–µ—à–∞–µ—Ç –ø–æ–≥—Ä—É–∂–µ–Ω–∏—é –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ –æ–±—É—á–µ–Ω–∏—è.", "–ù–µ—Ç, —ç—Ç–æ —Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞–µ—Ç –ø—É—Ç–∞–Ω–∏—Ü—É."],
    "entry.331049506": ["1", "2", "3", "4", "5"],
    "entry.1295596769": ["–ù–∞ —Ä–æ–¥–Ω–æ–º —è–∑—ã–∫–µ (–ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–µ–º—ã –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±—ã—Å—Ç—Ä–µ–µ –∏ –≥–ª—É–±–∂–µ).", "–ù–∞ —è–∑—ã–∫–µ –æ–±—É—á–µ–Ω–∏—è (–¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω –Ω–µ —Ä–æ–¥–Ω–æ–π, –º–Ω–µ –ø—Ä–æ—â–µ —É—Å–≤–∞–∏–≤–∞—Ç—å –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª –∏–º–µ–Ω–Ω–æ –Ω–∞ –Ω–µ–º).", "–°–º–µ—à–∞–Ω–Ω–æ: —Ç–µ—Ä–º–∏–Ω—ã –ª–µ–≥—á–µ –ø–æ–Ω–∏–º–∞—Ç—å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º/—è–∑—ã–∫–µ –æ–±—É—á–µ–Ω–∏—è, –∞ –æ–±—â—É—é —Å—É—Ç—å ‚Äî –Ω–∞ —Ä–æ–¥–Ω–æ–º —è–∑—ã–∫–µ.", "–†–∞–∑–Ω–∏—Ü—ã –Ω–µ—Ç, —è –æ–¥–∏–Ω–∞–∫–æ–≤–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–∞ –ª—é–±–æ–º –∏–∑ —è–∑—ã–∫–æ–≤."]
}

# --- –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ (–ø–æ—á–µ–º—É —ç—Ç–æ—Ç —è–∑—ã–∫ —É–¥–æ–±–µ–Ω) ---
phrases_by_category = {
    'native': [
        "–ù–∞ —Ä–æ–¥–Ω–æ–º —è–∑—ã–∫–µ —è –ª—É—á—à–µ –ø–æ–Ω–∏–º–∞—é —Å–ª–æ–∂–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ –Ω—É–∂–Ω–æ —Ç—Ä–∞—Ç–∏—Ç—å —Å–∏–ª—ã –Ω–∞ –ø–µ—Ä–µ–≤–æ–¥.",
        "–†–æ–¥–Ω–æ–π —è–∑—ã–∫ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–Ω–µ –±—ã—Å—Ç—Ä–µ–µ —Å—Ö–≤–∞—Ç—ã–≤–∞—Ç—å —Å—É—Ç—å, –æ—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ —Ä–µ—á—å –∏–¥—ë—Ç –æ –Ω–æ–≤—ã—Ö —Ç–µ—Ä–º–∏–Ω–∞—Ö.",
        "–ú–Ω–µ –ø—Ä–æ—â–µ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª –Ω–∞ —Ä–æ–¥–Ω–æ–º —è–∑—ã–∫–µ, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –∞—Å—Å–æ—Ü–∏–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã–º –æ–±—â–µ–Ω–∏–µ–º.",
        "–ù–∞ —Ä–æ–¥–Ω–æ–º —è–∑—ã–∫–µ –º–µ–Ω—å—à–µ –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, —è –º–æ–≥—É —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–∏, –∞ –Ω–µ –Ω–∞ —Ñ–æ—Ä–º–µ.",
        "–†–æ–¥–Ω–æ–π —è–∑—ã–∫ –¥–∞—ë—Ç –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ —è —á—É–≤—Å—Ç–≤—É—é –≤—Å–µ —Å–º—ã—Å–ª–æ–≤—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏.",
        "–ö–æ–≥–¥–∞ –º–∞—Ç–µ—Ä–∏–∞–ª —Å–ª–æ–∂–Ω—ã–π, —è –ª—É—á—à–µ –ø–æ–Ω–∏–º–∞—é –µ–≥–æ –Ω–∞ —Ä–æ–¥–Ω–æ–º —è–∑—ã–∫–µ, —ç—Ç–æ —ç–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è."
    ],
    'learning': [
        "–Ø –ø—Ä–∏–≤—ã–∫ –∫ —Ç–µ—Ä–º–∏–Ω–∞–º –Ω–∞ —è–∑—ã–∫–µ –æ–±—É—á–µ–Ω–∏—è, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤—Å—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞ –∏ –ª–µ–∫—Ü–∏–∏ –Ω–∞ –Ω—ë–º.",
        "–ú–Ω–µ –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ –Ω–∞ —è–∑—ã–∫–µ –æ–±—É—á–µ–Ω–∏—è —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è –∏ –æ–±—â–µ–ø—Ä–∏–Ω—è—Ç–∞—è –≤ –º–æ–µ–π —Å—Ñ–µ—Ä–µ.",
        "–≠—Ç–æ —è–∑—ã–∫ –º–æ–µ–π –±—É–¥—É—â–µ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏, –ø–æ—ç—Ç–æ–º—É —è —Å—Ç–∞—Ä–∞—é—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –¥–ª—è –≤—Å–µ—Ö —É—á–µ–±–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤.",
        "–í –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –∏ —É—á–µ–±–Ω–∏–∫–∞—Ö –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–∞ —ç—Ç–æ–º —è–∑—ã–∫–µ, –ø–æ—ç—Ç–æ–º—É —Ç–∞–∫ —É–¥–æ–±–Ω–µ–µ.",
        "–ù–∞ —è–∑—ã–∫–µ –æ–±—É—á–µ–Ω–∏—è –ø—Ä–æ—â–µ –æ–±—Å—É–∂–¥–∞—Ç—å —Ç–µ–º—ã —Å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è–º–∏ –∏ –æ–¥–Ω–æ–∫—É—Ä—Å–Ω–∏–∫–∞–º–∏.",
        "–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ —Å—Ç–∞—Ç—å–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –Ω–∞ —ç—Ç–æ–º —è–∑—ã–∫–µ, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å."
    ],
    'mixed': [
        "–ú–Ω–µ —É–¥–æ–±–Ω–æ —Å–º–µ—à–∏–≤–∞—Ç—å: –æ–±—â—É—é –∏–¥–µ—é –ø–æ–Ω–∏–º–∞—Ç—å –Ω–∞ —Ä–æ–¥–Ω–æ–º, –∞ —Ç–µ—Ä–º–∏–Ω—ã –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –Ω–∞ —è–∑—ã–∫–µ –æ–±—É—á–µ–Ω–∏—è.",
        "–Ø –±–∏–ª–∏–Ω–≥–≤, –ø–æ—ç—Ç–æ–º—É –¥–ª—è –º–µ–Ω—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É —è–∑—ã–∫–∞–º–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.",
        "–°–ª–æ–∂–Ω—ã–µ –≤–µ—â–∏ –ª–µ–≥—á–µ –æ—Å–º—ã—Å–ª–∏–≤–∞—Ç—å –Ω–∞ —Ä–æ–¥–Ω–æ–º, –Ω–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã –ø—Ä–æ—â–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ —è–∑—ã–∫–µ –æ–±—É—á–µ–Ω–∏—è.",
        "–ò–Ω–æ–≥–¥–∞ –Ω–∞ —Ä–æ–¥–Ω–æ–º —è–∑—ã–∫–µ –ª—É—á—à–µ –ø–æ–Ω–∏–º–∞–µ—Ç—Å—è –æ–±—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∞, –∞ –¥–µ—Ç–∞–ª–∏ –ª—É—á—à–µ –Ω–∞ —è–∑—ã–∫–µ –æ–±—É—á–µ–Ω–∏—è.",
        "–¢–∞–∫ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ —Å–ª–æ–∂–∏–ª–æ—Å—å: —è –≤—ã—Ä–æ—Å –≤ –¥–≤—É—è–∑—ã—á–Ω–æ–π —Å—Ä–µ–¥–µ, –∏ –º–æ–∑–≥ —Å–∞–º –≤—ã–±–∏—Ä–∞–µ—Ç —É–¥–æ–±–Ω—ã–π —è–∑—ã–∫."
    ],
    'none': [
        "–ú–Ω–µ –±–µ–∑ —Ä–∞–∑–Ω–∏—Ü—ã, —è –æ–¥–∏–Ω–∞–∫–æ–≤–æ —Ö–æ—Ä–æ—à–æ –ø–æ–Ω–∏–º–∞—é –Ω–∞ –ª—é–±–æ–º —è–∑—ã–∫–µ.",
        "–Ø –≤—ã—Ä–æ—Å –≤ –¥–≤—É—è–∑—ã—á–Ω–æ–π —Å—Ä–µ–¥–µ, –ø–æ—ç—Ç–æ–º—É –ª–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Å—å –∏ –Ω–µ –∑–∞–º–µ—á–∞—é —Ä–∞–∑–Ω–∏—Ü—ã.",
        "–î–ª—è –º–µ–Ω—è —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –≤–∞–∂–Ω–µ–µ —è–∑—ã–∫–∞, –≥–ª–∞–≤–Ω–æ–µ ‚Äî —á—Ç–æ–±—ã –±—ã–ª–æ –ø–æ–Ω—è—Ç–Ω–æ.",
        "–ù–µ—Ç –æ—Å–æ–±—ã—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π, –º–∞—Ç–µ—Ä–∏–∞–ª —É—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ.",
        "–Ø –æ–¥–∏–Ω–∞–∫–æ–≤–æ —Å–≤–æ–±–æ–¥–Ω–æ –≤–ª–∞–¥–µ—é –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —è–∑—ã–∫–∞–º–∏, –ø–æ—ç—Ç–æ–º—É —Ä–∞–∑–Ω–∏—Ü—ã –Ω–µ—Ç."
    ],
    'neutral': [
        "–ü—Ä–æ—Å—Ç–æ —Ç–∞–∫ —Å–ª–æ–∂–∏–ª–æ—Å—å.",
        "–ú–Ω–µ —Ç–∞–∫ —É–¥–æ–±–Ω–µ–µ.",
        "–ù–µ –∑–∞–¥—É–º—ã–≤–∞–ª—Å—è –æ–± —ç—Ç–æ–º.",
        "–¢–∞–∫ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ —Å–ª–æ–∂–∏–ª–æ—Å—å.",
        "–ü—Ä–∏–≤—ã—á–∫–∞.",
        "–õ–µ–≥—á–µ —É—Å–≤–∞–∏–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é."
    ]
}

# –ö–æ—Ä–æ—Ç–∫–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ—Ä–∞–∑—ã (–∏–Ω–æ–≥–¥–∞ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è)
popular_ones = ["–ü—Ä–æ—Å—Ç–æ —Ç–∞–∫", "–ú–Ω–µ —Ç–∞–∫ —É–¥–æ–±–Ω–µ–µ", "–ù–µ –∑–Ω–∞—é", "–£–¥–æ–±–Ω–æ", "–ü—Ä–∏–≤—ã—á–∫–∞"]

# ---------- –§—É–Ω–∫—Ü–∏–∏ ----------
def format_text_randomly(text):
    text = text.strip()
    if random.random() < 0.4 and text:
        text = text[0].lower() + text[1:]
    if text.endswith('.'):
        if random.random() < 0.5:
            text = text[:-1]
        elif random.random() < 0.1:
            text = text[:-1] + "..."
    else:
        if random.random() < 0.3:
            text += "."
    return text

def generate_profile(index, english_indices):
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞.
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å –∫–ª—é—á–∞–º–∏:
        age, gender, region, occupation, native_lang, school_lang, uni_lang
    """
    profile = {}

    # --- –†–æ–¥ –∑–∞–Ω—è—Ç–∏–π (—Å —É—á—ë—Ç–æ–º –≤–æ–∑—Ä–∞—Å—Ç–∞) ---
    occ_weights = [0.10, 0.85, 0.05]  # —à–∫–æ–ª–∞, —É–Ω–∏–≤–µ—Ä, —Ä–∞–±–æ—Ç–∞
    occupation = random.choices(options_map["entry.1467051264"], weights=occ_weights, k=1)[0]
    profile['occupation'] = occupation

    # --- –í–æ–∑—Ä–∞—Å—Ç (—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω —Å —Ä–æ–¥–æ–º –∑–∞–Ω—è—Ç–∏–π) ---
    age_options = options_map["entry.457041491"]
    if occupation == "–®–∫–æ–ª–∞":
        age_weights = [0.3, 0.7, 0.0, 0.0, 0.0]
    elif occupation == "–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç / –í—É–∑":
        age_weights = [0.0, 0.3, 0.5, 0.15, 0.05]
    else:  # –†–∞–±–æ—Ç–∞
        age_weights = [0.0, 0.0, 0.2, 0.3, 0.5]
    profile['age'] = random.choices(age_options, weights=age_weights, k=1)[0]

    # --- –ü–æ–ª ---
    profile['gender'] = random.choice(options_map["entry.900081255"])

    # --- –†–µ–≥–∏–æ–Ω ---
    regions = options_map["entry.2072137170"]
    region_weights = [0.25, 0.35, 0.20] + [0.20/17] * (len(regions)-3)
    profile['region'] = random.choices(regions, weights=region_weights, k=1)[0]

    # --- –†–æ–¥–Ω–æ–π —è–∑—ã–∫ ---
    if index in english_indices:
        native_lang = "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π"
    else:
        native_lang = random.choices(["–ö–∞–∑–∞—Ö—Å–∫–∏–π", "–†—É—Å—Å–∫–∏–π"], weights=[0.65, 0.35], k=1)[0]
    profile['native_lang'] = native_lang

    # --- –Ø–∑—ã–∫ –≤ —à–∫–æ–ª–µ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–æ–¥–Ω–æ–≥–æ —è–∑—ã–∫–∞) ---
    if native_lang == "–ö–∞–∑–∞—Ö—Å–∫–∏–π":
        school_lang = random.choices(
            ["–ö–∞–∑–∞—Ö—Å–∫–∏–π", "–†—É—Å—Å–∫–∏–π", "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π"],
            weights=[0.85, 0.10, 0.05], k=1)[0]
    elif native_lang == "–†—É—Å—Å–∫–∏–π":
        school_lang = random.choices(
            ["–ö–∞–∑–∞—Ö—Å–∫–∏–π", "–†—É—Å—Å–∫–∏–π", "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π"],
            weights=[0.10, 0.85, 0.05], k=1)[0]
    else:  # –ê–Ω–≥–ª–∏–π—Å–∫–∏–π
        school_lang = random.choices(
            ["–ö–∞–∑–∞—Ö—Å–∫–∏–π", "–†—É—Å—Å–∫–∏–π", "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π"],
            weights=[0.05, 0.10, 0.85], k=1)[0]
    profile['school_lang'] = school_lang

    # --- –Ø–∑—ã–∫ –æ–±—É—á–µ–Ω–∏—è (–¥–ª—è —É—á—ë–±—ã/—Ä–∞–±–æ—Ç—ã) ---
    if occupation == "–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç / –í—É–∑":
        if native_lang == "–ö–∞–∑–∞—Ö—Å–∫–∏–π":
            uni_weights = [0.30, 0.10, 0.40, 0.20]
        elif native_lang == "–†—É—Å—Å–∫–∏–π":
            uni_weights = [0.10, 0.35, 0.35, 0.20]
        else:
            uni_weights = [0.05, 0.05, 0.70, 0.20]
    elif occupation == "–®–∫–æ–ª–∞":
        if school_lang == "–ö–∞–∑–∞—Ö—Å–∫–∏–π":
            uni_weights = [0.90, 0.02, 0.01, 0.07]
        elif school_lang == "–†—É—Å—Å–∫–∏–π":
            uni_weights = [0.02, 0.90, 0.01, 0.07]
        else:
            uni_weights = [0.01, 0.01, 0.90, 0.08]
    else:  # –†–∞–±–æ—Ç–∞
        uni_weights = [0.30, 0.40, 0.10, 0.20]
    profile['uni_lang'] = random.choices(options_map["entry.2049384046"], weights=uni_weights, k=1)[0]

    return profile

def generate_one_response(index, english_indices, categorized):
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å
    profile = generate_profile(index, english_indices)

    data = {"fvv": "1"}

    # –ó–∞–ø–æ–ª–Ω—è–µ–º –æ—Ç–≤–µ—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ—Ñ–∏–ª—è
    data["entry.457041491"] = profile['age']
    data["entry.900081255"] = profile['gender']
    data["entry.2072137170"] = profile['region']
    data["entry.1467051264"] = profile['occupation']
    data["entry.997831765"] = profile['native_lang']
    data["entry.2016190063"] = profile['school_lang']
    data["entry.2049384046"] = profile['uni_lang']

    # –§–ª–∞–≥ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ –Ω–µ—Ä–æ–¥–Ω–æ–º —è–∑—ã–∫–µ (–∏—Å–∫–ª—é—á–∞—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–ø–∞–¥–∞—é—â–∏–π)
    native = profile['native_lang']
    uni = profile['uni_lang']
    is_studying_foreign = (uni != native) and (uni != "–°–º–µ—à–∞–Ω–Ω—ã–π (–Ω–µ—Å–∫–æ–ª—å–∫–æ —è–∑—ã–∫–æ–≤)")

    # --- 8. –õ–µ–≥–∫–æ—Å—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏—è ---
    if is_studying_foreign:
        understanding_weights = [0.05, 0.15, 0.45, 0.25, 0.10]
    else:
        understanding_weights = [0.0, 0.05, 0.15, 0.40, 0.40]
    data["entry.1708145665"] = random.choices(options_map["entry.1708145665"], weights=understanding_weights, k=1)[0]

    # --- 9. –¢—Ä—É–¥–Ω–æ—Å—Ç–∏ (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä) ---
    understanding_score = int(data["entry.1708145665"])
    if understanding_score >= 4:
        data["entry.1452720691"] = "–¢—Ä—É–¥–Ω–æ—Å—Ç–µ–π –Ω–µ—Ç, —è –≤—Å—ë –ø–æ–Ω–∏–º–∞—é."
    else:
        diffs = options_map["entry.1452720691"][:-1]
        chosen_diffs = random.sample(diffs, k=random.randint(1, 2))
        data["entry.1452720691"] = chosen_diffs

    # --- 10. –î–µ–π—Å—Ç–≤–∏–µ ---
    action_weights = [0.45, 0.30, 0.15, 0.10]
    data["entry.1794521284"] = random.choices(options_map["entry.1794521284"], weights=action_weights, k=1)[0]

    # --- 11. –ö–æ–¥-—Å–≤–∏—Ç—á–∏–Ω–≥ ---
    if is_studying_foreign or uni == "–°–º–µ—à–∞–Ω–Ω—ã–π (–Ω–µ—Å–∫–æ–ª—å–∫–æ —è–∑—ã–∫–æ–≤)":
        cs_weights = [0.60, 0.30, 0.10]
    else:
        cs_weights = [0.20, 0.40, 0.40]
    data["entry.286483656"] = random.choices(options_map["entry.286483656"], weights=cs_weights, k=1)[0]

    # --- 12. –ü–æ–º–æ—â—å –æ—Ç –ø–µ—Ä–µ—Ö–æ–¥–∞ ---
    if is_studying_foreign:
        help_weights = [0.65, 0.25, 0.10]
    else:
        help_weights = [0.20, 0.30, 0.50]
    data["entry.737822750"] = random.choices(options_map["entry.737822750"], weights=help_weights, k=1)[0]

    # --- 13. –£—Å–∏–ª–∏—è ---
    if is_studying_foreign:
        effort_weights = [0.05, 0.20, 0.40, 0.25, 0.10]
    else:
        effort_weights = [0.60, 0.20, 0.10, 0.05, 0.05]
    data["entry.331049506"] = random.choices(options_map["entry.331049506"], weights=effort_weights, k=1)[0]

    # --- 14. –ù–∞ –∫–∞–∫–æ–º —è–∑—ã–∫–µ –ª–µ–≥—á–µ (–æ–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞) ---
    if uni == native:
        # –û–±—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞ —Ä–æ–¥–Ω–æ–º —è–∑—ã–∫–µ
        data["entry.1295596769"] = "–ù–∞ —Ä–æ–¥–Ω–æ–º —è–∑—ã–∫–µ (–ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–µ–º—ã –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±—ã—Å—Ç—Ä–µ–µ –∏ –≥–ª—É–±–∂–µ)."
    elif uni == "–°–º–µ—à–∞–Ω–Ω—ã–π (–Ω–µ—Å–∫–æ–ª—å–∫–æ —è–∑—ã–∫–æ–≤)":
        # –°–º–µ—à–∞–Ω–Ω—ã–π —è–∑—ã–∫ –æ–±—É—á–µ–Ω–∏—è
        easier_weights = [0.30, 0.10, 0.50, 0.10]  # —Ä–æ–¥–Ω–æ–π, —è–∑—ã–∫ –æ–±—É—á–µ–Ω–∏—è, —Å–º–µ—à–∞–Ω–Ω–æ, –±–µ–∑ —Ä–∞–∑–Ω–∏—Ü—ã
        data["entry.1295596769"] = random.choices(options_map["entry.1295596769"], weights=easier_weights, k=1)[0]
    else:
        # –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –Ω–µ—Ä–æ–¥–Ω–æ–º (–∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º) —è–∑—ã–∫–µ
        easier_weights = [0.40, 0.15, 0.35, 0.10]
        data["entry.1295596769"] = random.choices(options_map["entry.1295596769"], weights=easier_weights, k=1)[0]

    # --- 15. –í—ã–±–æ—Ä —Ñ—Ä–∞–∑—ã (—Å —É—á—ë—Ç–æ–º –æ—Ç–≤–µ—Ç–∞ –Ω–∞ 14) ---
    choice_14 = data["entry.1295596769"]
    if "–ù–∞ —Ä–æ–¥–Ω–æ–º —è–∑—ã–∫–µ" in choice_14:
        target_cat = 'native'
    elif "–ù–∞ —è–∑—ã–∫–µ –æ–±—É—á–µ–Ω–∏—è" in choice_14:
        target_cat = 'learning'
    elif "–°–º–µ—à–∞–Ω–Ω–æ" in choice_14:
        target_cat = 'mixed'
    elif "–†–∞–∑–Ω–∏—Ü—ã –Ω–µ—Ç" in choice_14:
        target_cat = 'none'
    else:
        target_cat = 'neutral'

    # –í—ã–±–∏—Ä–∞–µ–º —Ñ—Ä–∞–∑—É: –≤ 90% —Å–ª—É—á–∞–µ–≤ –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∏–Ω–∞—á–µ –∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫–æ—Ä–æ—Ç–∫–∏—Ö
    if random.random() < 0.9:
        if categorized[target_cat]:
            ans = categorized[target_cat].pop(0)
        elif categorized['neutral']:
            ans = categorized['neutral'].pop(0)
        else:
            # –ï—Å–ª–∏ –Ω—É–∂–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ø—É—Å—Ç–∞, –±–µ—Ä—ë–º –∏–∑ –ª—é–±–æ–π –Ω–µ–ø—É—Å—Ç–æ–π
            for cat in ['native', 'learning', 'mixed', 'none', 'neutral']:
                if categorized[cat]:
                    ans = categorized[cat].pop(0)
                    break
            else:
                ans = random.choice(popular_ones)
    else:
        ans = random.choice(popular_ones)

    ans = format_text_randomly(ans)
    data["entry.593581296"] = ans
    data["pageHistory"] = "0"

    return data, ans, categorized

def load_state():
    if os.path.exists(STATE_FILE):
        with open(STATE_FILE, 'r') as f:
            return json.load(f)
    else:
        # –°–æ–∑–¥–∞—ë–º –∫–æ–ø–∏–∏ —Å–ø–∏—Å–∫–æ–≤ —Ñ—Ä–∞–∑ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º
        categorized = {}
        for cat, phrases in phrases_by_category.items():
            cat_phrases = phrases.copy()
            random.shuffle(cat_phrases)
            categorized[cat] = cat_phrases

        # –ò–Ω–¥–µ–∫—Å—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö —Ä–æ–¥–Ω–æ–π —è–∑—ã–∫ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π (–º–∞–ª–µ–Ω—å–∫–∞—è –¥–æ–ª—è)
        english_indices = random.sample(range(TOTAL_RESPONSES), 2)

        return {
            'sent_count': 0,
            'english_indices': english_indices,
            'categorized': categorized
        }

def save_state(state):
    with open(STATE_FILE, 'w') as f:
        json.dump(state, f, ensure_ascii=False, indent=2)

def main():
    state = load_state()
    sent_count = state['sent_count']
    english_indices = state['english_indices']
    categorized = state['categorized']

    if sent_count >= TOTAL_RESPONSES:
        print(f"–í—Å–µ {TOTAL_RESPONSES} –∞–Ω–∫–µ—Ç —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã. –ó–∞–≤–µ—Ä—à–∞–µ–º.")
        return

    print(f"–û—Ç–ø—Ä–∞–≤–∫–∞ –∞–Ω–∫–µ—Ç—ã #{sent_count + 1}...")

    payload, phrase, updated_categorized = generate_one_response(sent_count, english_indices, categorized)

    # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
    if random.random() < 0.7:
        delay = random.uniform(0, 30)
        print(f"‚è≥ –ó–∞–¥–µ—Ä–∂–∫–∞ {delay:.1f} —Å–µ–∫")
        time.sleep(delay)

    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36',
        'Referer': 'https://docs.google.com/forms/d/e/1FAIpQLSce7JvrJXbHWyWDoJmInk5A4sY5F_-4sUoQB-2G8-XC_N5Kwg/viewform',
        'Origin': 'https://docs.google.com',
    }

    try:
        response = requests.post(URL, data=payload, headers=headers)
        if response.status_code == 200:
            print(f"‚úÖ –ê–Ω–∫–µ—Ç–∞ #{sent_count + 1} –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞. –§—Ä–∞–∑–∞: \"{phrase}\"")
            state['sent_count'] = sent_count + 1
            state['categorized'] = updated_categorized
            save_state(state)
        else:
            print(f"‚ùå –û—à–∏–±–∫–∞: —Å—Ç–∞—Ç—É—Å {response.status_code}")
            print(f"–¢–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞: {response.text[:200]}")
    except Exception as e:
        print(f"üî¥ –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: {e}")

if __name__ == "__main__":
    main()
